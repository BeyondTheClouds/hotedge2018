%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

%\section{Design Considerations}
%\label{design_considerations}

\section{System Design}
\label{sec:system_design_considerations}
As previously mentioned, the starting point for this study is an edge
infrastructure composed of hundreds of micro DCs (\aka edge sites)
operated by the OpenStack software suite.
%
OpenStack is composed of two kinds
of nodes: on the one hand, the compute/storage/network nodes are
dedicated to deliver the XaaS capabilities, such as hosting VMs (\ie,
data plane); on the other hand, the control nodes are in charge of
executing the OpenStack services (\ie, control plane).
%
Although each edge site provides enough resources to host control and
compute capabiliities, several deployments scenarios can be
envisioned, including one global or several OpenStack instances. In
this section, we discuss two particular scenarios. The first one
consists in deploying all control services on one site of the
infrastructure and considering remote resources as compute
nodes.  The second one corresponds to the guidelines presented on the
OpenStack website to supervise a multi-regions infrastructure.
%
This preliminary discussion, which considers two extreme deployment
scenarios, enables us to justify why collaborations is mandatory to
fulfill the requirements identified in Section~\ref{sec:requirements}.
%
We emphasize that although OpenStack has been considered, alternative
systems such as Kubernetes would have been lead to the same conclusion
in terms of resource management and collaboration needs.  \AL{Put
  references Kubernetes}

\subsection{Centralized Management and Remote Compute/Storage/Network Nodes}
\label{subsec:centralized_os}
At coarse-grained, the first scenario consists in operating an edge
infrastructure like a traditional cloud computing one.  The ``only''
difference is related to the wide-area network links between the
control services and the compute nodes.  Futhermore, it might be
possible to define multiple availability zones in order to make a
distinction between each geographical location.
%
Technically speaking, OpenStack services are organized following the Shared Nothing
principle. Each instance of a service (i.e., service worker) is
exposed through an API accessible through a Remote Procedure Call
(RPC) system implemented, on top of a messaging queue or via web
services (REST). This enables a weak coupling between services and
thus a large number of deployment possibilities such as this one.
%
Ã¸From the requirements viewpoint (see Section~\ref{sec:requirement}) L1
and most of the L2 features~\footnote{Because the infrastructure can
  be spread over several network domains, advanced network operations
  cannot be satisfied without any change in the OpenStack codebase.}
can be fulfilled in a straightforward way.  However, in addition to
the scalability limitation that will prevent such a deployment of
managing thousands of compute nodes, it is not possible to satisfy the
L3 expectations.  Even if the organization of the OpenStack services
respects the Shared Nothing principle, most services create and
manipulate logical objects that are persisted in shared
databases. While this enables service workers to easily collaborate,
it imposes a permanent connectiviy between compute nodes, services and
their DBs. In other ways, this scenario provides a Single Pane of
Glass for the administrator viewpoint but at the same time is a Single
Point of Failure).\AL{Fix this last sentence}


\subsection{Segregate into Regions}


\subsection{Effective Collaboration is Needed}
Each Edge Site
provides control and compute capabilities (see~\ref{sec:requirements})
on top of dozens of servers. They \emph{collaborate} with each-other
to shape up the Edge Infrastructure and a Wide Area Network (WAN)
interconnects them through both wired and wireless network links. This
results in up to 300ms of RTT between two Edge Sites and common
disconnections.

Despite the fallibility of the network, and frequent isolation risks
of an Edge Site from the rest of the Infrastructure (\ie network
split-brain), the Edge Infrastructure may be kept sustainable. This is
achieved by supposing a collaboration a la peer-to-peer, that is, an
Edge Site always serves local resources and collaborates with other
Edge Sites if needed. Thus, a user can make a SSH on his VM during a
network split-brain if he gets a local access to the Edge Site. The
same user can also start a VM using the VMI of an other Edge Site if
the collaboration can be established.

When it comes to develop this resource management system for the Edge
computing, the developer has two fundamental design options: a \emph{top-down} or
\emph{bottom-up}. Both designs impact how to handle the
collaboration needed by such a system.

\paragraph{Top-Down Collaboration}
Design option that implements the collaboration required by
federating IaaS managers' API. In other words, it leverages on existing IaaS platforms as they are made available today without introducing modifications/extensions. Examples of approaches following a \emph{top-down} design are: ONAP~\cite{onap}, Kingbird~\cite{kingbird}, FogBow~\cite{brasileiro2016fogbow} and p2p-OpenStack~\cite{ericsson-p2p}


\paragraph{Bottom-Up Collaboration} Design option that lays on making IaaS mechanisms/services directly collaborative. For example, having two OpenStack Nova services able to cooperate and communicate directly would be a realization of a \emph{bottom-up} design. Such design option implies either the modification/extension of existing IaaS platforms or the creation of a completely new system. Examples of approaches following a \emph{bottom-up} design are:
\AL[Comment by Joao]{Any reference to existing approaches? Guys, do you have, for example, references to your keystone shared db work? Could cells be considered as an example? }

On the one hand, \emph{top-down} options have been the most explored, but can these alone fulfil all expected requirements? On the other hand, \emph{bottom-up} options seem to disruptive the design principles of most existing IaaS platform, but is that in fact the case?
